# uBlockフィルター データマイグレーションガイド

## 概要

バージョン 2.2.5 以降、uBlockフィルターのストレージ形式が変更されました。

## 変更内容

### 旧形式 (v2.2.4以前)

```json
{
  "blockRules": [
    { "domain": "example.com", "pattern": "example.com", "options": {} }
  ],
  "exceptionRules": [
    { "domain": "safe.com", "pattern": "safe.com", "options": {} }
  ],
  "metadata": { ... }
}
```

### 新形式 (v2.2.5以降)

```json
{
  "blockDomains": ["example.com", "test.com"],
  "exceptionDomains": ["safe.com"],
  "metadata": { ... }
}
```

## 自動マイグレーション

v2.2.4以前のデータを持っているユーザーは、初回起動時に自動的に新形式へマイグレーションされます。

- マイグレーションは拡張機能のバックグラウンド（設定読み込み時）に自動実行されます
- 既存のルールはすべて保持されます
- マイグレーションは一度だけ実行されます

## メリット

- ストレージ使用量の大幅な削減（約70%削減）
- マッチング処理の高速化
- 大規模なフィルターリストでのパフォーマンス向上

## 注意点

- マイグレーションは不可逆です（新形式から旧形式へは戻れません）
- マイグレーションが正常に完了するまで拡張機能を使用していないことを推奨します
- マイグレーション前のデータは自動的に上書きされます