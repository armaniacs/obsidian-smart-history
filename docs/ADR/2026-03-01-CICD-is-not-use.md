# CI/CDを使用しない

## 状況（Status）

承認済み (Accepted)

## 文脈（Context）

Obsidian Weave は Chrome Extension (Manifest V3) として開発されており、以下の特徴を持っている：

1. **クライアントサイドのみの拡張機能** - サーバーサイドコンポーネントを持たない
2. **ユーザーデバイスでの実行** - Service Worker と Content Script のみで構成
3. **外部API依存** - すべての通信はユーザーが設定した AI プロバイダー宛て
4. **小規模開発チーム** - 個人開発者または小規模チームによる保守

Checking Team レビュー（2026-03-01）において、以下の指摘があった：

> SRE/Ops Specialist レビュー:
> - CI/CD パイプラインの整備が不完全
> - GitHub Actions による自動テスト統合がない
> - Chrome Web Store API による自動リリースフローがない

指摘自体は技術的正確性を持つが、本プロジェクトのスコープと開発スタイルにおいて CI/CD の導入は過剰な工数となる。

## 決定内容（Decision）

**Obsidian Weave プロジェクトでは CI/CD を採用せず、手動ビルド・手動リリースフローを継続する。**

### 理由

1. **Chrome Extension の制約**
   - Chrome Web Store への公開は必ず手動レビューを経過する
   - 自動化できるのは「ビルド」までで、「公開」は人的作業が必要
   - ビルドは `npm run build` の一撃で完了する

2. **開発規模の適合性**
   - 個人開発プロジェクトであり、マージ競合やコンフリクトのリスクが低い
   - ローカル環境でのテスト実行が十分可能（`npm test`, `npm run test:e2e`）

3. **コスト対効果**
   - CI/CD 環境の構築・維持コスト > 手動プロセスの時間コスト
   - CI/CD が解決する問題（複数開発者との協調、本番環境への自動デプロイ等）が存在しない

4. **簡潔性の維持**
   - 依存ツールや設定ファイルの最小化
   - 新規開発者がプロジェクトを理解する際の学習コスト削減

### 手動フローの定義

#### ビルド手順
```bash
npm run clean
npm run build
```

これにより `dist/` ディレクトリに配布用ファイルが出力される。

#### リリース手順
1. `package.json` のバージョン番号を更新
2. `npm run build` でビルド
3. `dist/` を zip で圧縮
4. Chrome Web Store Developer Dashboard に手動アップロード
5. 本番環境へ公開

#### 変更履歴の管理
- `CHANGELOG.md` でバージョンごとの変更を記録（手動更新）

### 実施しないもの

- GitHub Actions による自動テスト
- 自動セマンティックリリース
- Chrome Web Store API による自動パブリッシュ
- Docker container 等、ビルド環境のコンテナ化

## 結果（Consequences）

### 正の影響

- 設定ファイルの簡潔化（`.github/workflows/` が不要）
- プロジェクト構造がシンプルになり、理解しやすい
- 外部サービスへの依存がない（GitHub Actions の障害に影響されない）
- 個人開発者にとって現実的な運用コスト

### 負の影響

- テスト実行がローカルでのみ（リモートでの自動実行なし）
- ビルド手順を手動で行う必要がある（ただし1コマンドで完了）
- CHANGELOG 更新を忘れるリスク

### 対策（負の影響の緩和）

- `README.md` にビルド・リリース手順を明記
- `CONTRIBUTING.md` でテスト実行を奨励
- プルリクエスト作成時に「テスト実行済み」を確認

## 関連決定

- なし

## 撤回条件（Reversal）

以下の条件が満たされた場合、この決定を見直す：

1. 複数開発者が同時に作業する必要が出現した場合
2. 頻繁なリリース（週1回以上）が必要になった場合
3. 自動化による品質向上のニーズが高まった場合
4. チーム規模が拡大し、手動プロセスのボトルネックが明確になった場合

## 履歴

| 日付 | 変更内容 |
|------|----------|
| 2026-03-01 | 初版作成 |